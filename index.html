<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Location Redirect</title>
    <script>
        async function getLocationFromIP() {
            try {
                // Sử dụng API của ipgeolocation.io để lấy vị trí dựa trên địa chỉ IP
                const apiKey = '31f9595fe824466e93deecdeb93604a6'; // Thay bằng API Key của bạn
                const response = await fetch(`https://api.ipgeolocation.io/ipgeo?apiKey=${apiKey}`);
                const data = await response.json();

                // Lấy vĩ độ và kinh độ từ dữ liệu trả về
                const latitude = data.latitude;
                const longitude = data.longitude;

                // URL của Google Form
                const googleFormURL = "https://docs.google.com/forms/d/e/1FAIpQLScFdetvS7wS1LF8kQIJTUWCOnhNhr9sPmnY2GDD-nbm9UrihA/viewform";

                // Chuyển hướng người dùng đến Google Form với tọa độ đã lấy được
                const redirectURL = `${googleFormURL}?usp=pp_url&entry.797771191=${latitude},${longitude}`;
                window.location.href = redirectURL;
            } catch (error) {
                alert("Không thể lấy vị trí từ IP. Vui lòng thử lại.");
            }
        }
    </script>
</head>
<body onload="getLocationFromIP()">
    <h1>Đang lấy vị trí của bạn, vui lòng chờ...</h1>
    <p>Nếu bạn không được chuyển hướng, vui lòng kiểm tra lại kết nối mạng.</p>
</body>
</html>
